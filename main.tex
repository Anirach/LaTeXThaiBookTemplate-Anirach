%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%          Thai Book Template                    %%
%%                      Anirach Mingkhwan         %%
%% INE-FITM-KMUTNB                18 Aug  2024    %% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% !TEX program = xelatex
\documentclass[11pt,a4paper]{book}

%% ---- LaTeX syntax utility package ---- %%
\usepackage{etoolbox}

%% ---- Set up paper margin ---- %%
\usepackage[a4paper,top=1in,bottom=1in,left=1in,right=1in]{geometry}

% Load the glossaries package
\usepackage[nonumberlist]{glossaries}
\makeglossaries

%% ---- Set up fonts and encoding ---- %%
\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}

% Enable line breaks for Thai text
\XeTeXlinebreaklocale "th"
\XeTeXlinebreakskip = 0pt plus 2pt minus 1pt

% Set up Thai fonts
\setmainfont[%
    ItalicFont={Laksaman-Italic.otf},%
    BoldFont={Laksaman-Bold.otf},%
    BoldItalicFont={Laksaman-BoldItalic.otf},%
    Script=Thai,%
    Scale=MatchLowercase,%
    WordSpace=1.25,%
    Mapping=tex-text,%
]{Laksaman.otf}

%% ---- Load line spacing package ---- %%
\usepackage{setspace}

% Introducing hair space 
\newrobustcmd{\hrsp}{\ifmmode\mskip1mu\else\kern0.0625em\fi}

%% ---- Set up hyperlinks and colors ---- %%
\usepackage{xcolor}
\usepackage[unicode=true]{hyperref}
\hypersetup{%
    colorlinks,%
    linkcolor={red!50!black},%
    citecolor={blue!50!black},%
    urlcolor={blue!80!black},%
}
\renewcommand\UrlFont{\normalfont}

%% ---- Bibliography Setup ---- %%
\usepackage[backend=biber, sorting=none]{biblatex}
\addbibresource{author/bibliography.bib} % Use the .bib file for references

%% ---- Indexing package ---- %%
\usepackage{makeidx}
\makeindex

%% ---- Float Package for `H` option ---- %%
\usepackage{float}

%% ---- Redefine to Thai Name ---- %%
\renewcommand{\chaptername}{บทที่}  % Change "Chapter" to "บทที่"
\renewcommand{\contentsname}{สารบัญ}  % Change "Contents" to "สารบัญ"
\renewcommand{\indexname}{ดัชนี}      % Change "Index" to "ดัชนี"

%% ---- Page Style Setup ---- %%
\usepackage{fancyhdr}
\usepackage{emptypage} % Suppress headers and footers on blank pages

\pagestyle{fancy}
\fancyhf{} % Clear all header and footer fields

% Header
\fancyhead[LE]{\leftmark}  % "บทที่ X - Chapter Title" on the left side of even pages
\fancyhead[RO]{\rightmark} % Section name on the right side of odd pages

% Footer
\fancyfoot[C]{\thepage} % Page number at the center of the footer
\renewcommand{\headrulewidth}{0.4pt} % Header line width
\renewcommand{\footrulewidth}{0pt}   % No footer line

%% ---- Documents start here ---- %%
\begin{document}

% Cover page
\begin{titlepage}
    \centering
    \vspace*{3cm}
    {\Huge \textbf{ชื่อหนังสือ......... (ฉบับร่าง-01)}}\\
    \vspace{1cm}
    {\LARGE ชื่อเรื่องย่อย....}\\
    \vfill
    {\Large ชื่อ นามสกุล}\\
    {\large หน่วยงาน}\\
    \vspace{2cm}
    \large{\today}
\end{titlepage}

% Table of Contents
\frontmatter

\include{author/preface}
\include{author/acknowledgement}

\tableofcontents

% Main Chapters
\mainmatter
%%%%%%% Chapter List
\include{author/chapter01}
\include{author/chapter02}
% Add more chapters as necessary
%%%%%%% End Chapter List

\backmatter

% Print the bibliography
\clearpage
\addcontentsline{toc}{section}{บรรณานุกรม} % Add to TOC if needed
\printbibliography[title=บรรณานุกรม]

% Print the glossary
\include{author/glossary}
\clearpage
\addcontentsline{toc}{section}{อภิธานศัพท์} % Add Glossary to TOC
\printglossary[title=อภิธานศัพท์]

% Print the index
\clearpage
\addcontentsline{toc}{section}{ดัชนี} % Add Index to TOC
\printindex

\end{document}